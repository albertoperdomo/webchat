<% content_for :head do %>
  <%= javascript_include_tag "/static/Orbited" %>
  <script>TCPSocket = Orbited.TCPSocket</script>
  <%= javascript_include_tag "/static/protocols/xmpp/xmpp" %>
  <%= javascript_include_tag "chat" %>
  <script>
    user_name = "<%= current_user.login %>";
    user_token = "<%= current_user.single_access_token %>";
  </script>
<% end %>
<h1>Chat</h1>

<div id="user_list">
  <h2>Users</h2>
  <% remote_form_for "chat_contact", :url => { :controller => "chat_contacts", :action => "create" }, :html => { :id => 'new_chat_contact' } do |f| %>
    <h3>Add contact</h3>
    <%= f.text_field 'jid' %>
    <%= f.submit "Add contact" %>
  <% end %>
  <div class="stroke_border">
    <ul id="roster">
    </ul>
  </div>
</div>

<div id="new_message">
  <h2>New message</h2>
  <% remote_form_for "chat_message", :url => { :controller => "chat_messages", :action => "create" }, :html => { :id => 'send_chat_message' } do |f| %>
    <label for="recipient_id">Recipient's JID<label>
    <%= f.text_field 'recipient_id' %>
    <label for="content">Message<label>
    <%= f.text_field 'content' %>
    <%= f.submit "Send message" %>
  <% end %>
</div>

<div id="chat_box" class="stroke_border">
  <h2>CHAT</h2>
</div>
